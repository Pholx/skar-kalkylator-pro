<!DOCTYPE html>
<html lang="sv">
<head>
<link rel="manifest" href="manifest.json">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üõ†Ô∏è Sk√§rdata PRO</title>
    <style>
        :root {
            --primary: #2563eb; --success: #059669; --warning: #d97706; --danger: #dc2626;
            --bg-gradient: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            --card-bg: #ffffff; --input-bg: #f8fafc; --border: #e2e8f0;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-gradient); min-height: 10vh; padding: 15px; color: #1e293b;
        }
        .app { max-width: 440px; margin: 0 auto; background: var(--card-bg); 
               border-radius: 24px; padding: 28px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.25); position: relative; }
        .app::before { content: ''; position: absolute; top: 0; left: 0; right: 0; 
                       height: 6px; background: linear-gradient(90deg, var(--primary), var(--success), var(--warning)); border-radius: 24px 24px 0 0; }
        
        /* Flikar med 3 kolumner, justerat f√∂r 5 flikar */
        .tabs { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 8px;
            background: none; 
            margin-bottom: 24px; 
            overflow: visible; 
            justify-content: space-around;
        }
        .tab { 
            flex-grow: 1; 
            /* 6 tabs totalt, 3 rader */
            flex-basis: calc(33.333% - 6px); 
            min-width: 100px;
            
            padding: 12px 8px; 
            background: var(--input-bg); 
            border: 1px solid var(--border); 
            border-radius: 12px;
            font-weight: 700; 
            font-size: 14px; 
            cursor: pointer; 
            transition: all 0.3s; 
            text-align: center; /* Centrera text i knappen */
        }
        /* Korrigering f√∂r 6 flikar i tre rader */
        .tabs button:nth-child(n+4) {
             flex-basis: calc(33.333% - 6px);
        }
        
        .tab.active { 
            background: var(--primary); 
            color: white; 
            border-color: var(--primary);
        }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        .header { text-align: center; padding: 20px 0; 
                  background: linear-gradient(135deg, var(--primary) 0%, #3b82f6 100%);
                  color: white; border-radius: 16px; margin-bottom: 24px; }
        .header h1 { font-size: 24px; font-weight: 800; margin-bottom: 4px; }
        .header p { font-size: 14px; opacity: 0.95; font-weight: 500; }
        
        .input-group { background: var(--input-bg); padding: 24px; border-radius: 20px; 
                       margin-bottom: 24px; border: 2px solid var(--border); }
        .input-row { 
            display: flex; align-items: center; margin-bottom: 18px; 
            gap: 12px;
        }
        .input-row:last-child { margin-bottom: 0; }
        
        .label { 
            font-weight: 700; color: #1e40af; 
            width: 55px;
            font-size: 13px; display: flex; align-items: center; gap: 4px; 
            flex-shrink: 0; justify-content: flex-end;
        }
        .icon { font-size: 14px; }
        select, input[type="number"] { 
            width: 65%;
            flex-grow: 0;
            flex-shrink: 1;
            
            padding: 12px 14px; border: 2px solid var(--border); 
            border-radius: 12px; font-size: 16px; background: white; 
            font-weight: 600; transition: all 0.3s; 
        }
        select:focus, input[type="number"]:focus { 
            border-color: var(--primary); outline: none; 
            box-shadow: 0 0 0 4px rgba(37,99,235,0.1); 
        }
        .unit { 
            font-size: 13px; color: #64748b; font-weight: 600; 
            width: 55px;
            text-align: center; flex-shrink: 0;
        }
        
        .auto-calc { background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%); 
                     padding: 20px; border-radius: 16px; margin-bottom: 28px; 
                     border: 2px solid #bbf7d0; }
        .auto-row { display: flex; justify-content: space-between; align-items: center; 
                    margin-bottom: 14px; padding: 10px 0; border-bottom: 1px solid rgba(34,197,94,0.2); }
        .auto-row:last-child { margin-bottom: 0; border-bottom: none; }
        .auto-label { font-size: 15px; color: #166534; font-weight: 600; }
        .auto-value { font-size: 16px; font-weight: 800; color: #15803d; 
                      background: rgba(34,197,94,0.1); padding: 6px 12px; 
                      border-radius: 20px; min-width: 70px; text-align: center; }
        
        .results { background: linear-gradient(135deg, var(--success) 0%, #10b981 100%); 
                   border-radius: 24px; padding: 28px; color: white; margin-bottom: 28px; }
        .result-item { display: flex; justify-content: space-between; align-items: center; 
                       padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.15); }
        .result-item:last-child { border-bottom: none; }
        .result-label { font-size: 17px; font-weight: 600; display: flex; align-items: center; gap: 10px; }
        .result-value { font-size: 24px; font-weight: 900; color: #fef3c7; 
                        text-shadow: 0 4px 12px rgba(0,0,0,0.3); min-width: 120px; text-align: right; 
                        white-space: nowrap; /* F√∂rhindra radbrytning p√• resultat */ }
        
        /* NYTT: Toggling Tips Box */
        .tips-container { 
            margin-top: 28px;
            border: 2px solid var(--warning); 
            border-radius: 20px;
            overflow: hidden; 
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%); 
            color: #92400e; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .tips-header {
            padding: 18px 24px;
            cursor: pointer;
            background: linear-gradient(135deg, #fef3c7 0%, #ffe499 100%);
            border-bottom: 2px solid var(--warning);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .tips-header h3 {
            font-size: 18px; 
            font-weight: 800; 
            color: var(--warning); 
            margin: 0;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #tips-toggle-icon {
            font-size: 24px;
            font-weight: 300;
            transition: transform 0.3s;
            line-height: 1;
        }

        .tips-content {
            max-height: 0;
            padding: 0 24px; 
            transition: max-height 0.4s ease-out, padding 0.4s ease-out;
        }

        .tips-content.expanded {
            max-height: 600px; /* Tillr√§ckligt stort f√∂r att rymma allt inneh√•ll */
            padding: 20px 24px;
        }

        /* Tip content styling */
        .tip-category { margin-bottom: 15px; border-left: 4px solid #f59e0b; padding-left: 10px; }
        .tip-category strong { font-size: 14px; color: #a16207; display: block; margin-bottom: 4px; font-weight: 700; }
        .tip-category ul { list-style: disc; padding-left: 20px; }
        .tip-category li { font-size: 13px; margin-bottom: 5px; line-height: 1.4; }
        .tip-category .good { color: var(--success); font-weight: 600; }
        .tip-category .bad { color: var(--danger); font-weight: 600; }
        
        .reset-btn { width: 100%; padding: 20px; background: linear-gradient(135deg, #64748b 0%, #475569 100%);
                     color: white; border: none; border-radius: 16px; font-size: 18px; font-weight: 700;
                     cursor: pointer; transition: all 0.3s; margin-top: 20px;}
        .reset-btn:hover { transform: translateY(-1px); }
        .reset-btn:active { transform: translateY(2px); }
        
        /* Media query f√∂r mobil-vy */
        @media (max-width: 480px) {
            .app { margin: 10px; padding: 20px; }
            .input-row { flex-direction: column; gap: 12px; align-items: stretch; }
            .label { width: auto; justify-content: flex-start; }
            .unit { width: auto; }
            
            select, input[type="number"] {
                width: 100%;
                flex-grow: 1; 
            }
            .tab {
                flex-basis: calc(50% - 4px); /* 2 kolumner p√• sm√• sk√§rmar */
            }
        }
        /* F√∂r sm√• sk√§rmar, √•terg√• till 2 kolumner f√∂r tabs */
        @media (max-width: 380px) {
            .tab {
                flex-basis: calc(50% - 4px);
            }
        }
    </style>
</head>
<body>
    <div class="app">
        <div class="header">
            <h1>üõ†Ô∏è Sk√§rdata PRO</h1>
            <p><strong>üîí S√§kra & Optimerade v√§rden</strong></p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('frasning')">ü™ö Fr√§sning</button>
            <button class="tab" onclick="switchTab('planfrasning')">üî≤ Planfr√§sning</button>
            <button class="tab" onclick="switchTab('gangfrasning')">üî© G√§ngfr√§sning</button>
            <button class="tab" onclick="switchTab('borrning')">üï≥Ô∏è Borrning</button>
            <button class="tab" onclick="switchTab('brotschning')">‚öôÔ∏è Brotschning</button>
            <button class="tab" onclick="switchTab('svarvning')">üîÑ Svarvning</button> </div>

        <div id="frasning" class="tab-content active">
            <div class="input-group">
                <div class="input-row">
                    <label class="label"><span class="icon">üè≠</span>Mat</label>
                    <select id="frasning-material">
                        <option value="mjukt" selected>Mjukt st√•l</option>
                        <option value="toolox44">Toolox 44</option>
                        <option value="hart">H√•rt st√•l</option>
                        <option value="aluminium">Aluminium</option>
                        <option value="rostfritt">Rostfritt st√•l</option>
                        <option value="hardat60">H√§rdat st√•l 60HRC</option>
                        <option value="plast">Plast</option>
                        <option value="koppar">Koppar</option>
                    </select>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚öôÔ∏è</span>Dia</label>
                    <input type="number" id="frasning-diameter" value="12" step="0.1" min="0.5">
                    <span class="unit">mm</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚ö°</span>Vc</label>
                    <input type="number" id="frasning-vc" value="" step="1" min="1" placeholder="Auto">
                    <span class="unit">m/min</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üî™</span>ap</label>
                    <input type="number" id="frasning-ap" value="5" step="0.5" min="0.1">
                    <span class="unit">mm</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üìê</span>Ingr</label>
                    <input type="number" id="frasning-ingrepp" value="10" step="1" min="1" max="100">
                    <span class="unit">%</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">ü¶∑</span>Z</label>
                    <input type="number" id="frasning-tander" value="4" step="1" min="1">
                    <span class="unit">st</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üçΩÔ∏è</span>fz</label>
                    <input type="number" id="frasning-fz" value="0.060" step="0.001" min="0.001">
                    <span class="unit">mm/t</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚öôÔ∏è</span>MaxN</label>
                    <input type="number" id="frasning-max-rpm" value="" step="10" min="1" placeholder="Valfritt">
                    <span class="unit">r/min</span>
                </div>
            </div>
            
            <div class="auto-calc">
                <div class="auto-row">
                    <span class="auto-label">üéØ Vc Auto</span>
                    <span class="auto-value" id="frasning-vcAuto">220</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">Kc (Spec. Kraft)</span>
                    <span class="auto-value" id="frasning-kc">1500 N/mm¬≤</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">‚öôÔ∏è fz-justering</span>
                    <span class="auto-value" id="frasning-justeringFz">100%</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">üîß fz Matningskorr.</span>
                    <span class="auto-value" id="frasning-fzJust">0.103</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">üìè Ingrepp</span>
                    <span class="auto-value" id="frasning-ingreppsFaktor">1.72</span>
                </div>
            </div>
            <div class="results">
                <div class="result-item">
                    <span class="result-label"><span class="icon">‚öôÔ∏è</span> Varvtal</span>
                    <span class="result-value" id="frasning-varvtal">5831</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üöÄ</span> Matning Grov</span>
                    <span class="result-value" id="frasning-matning-grov">2408</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">‚ú®</span> Matning Fin</span>
                    <span class="result-value" id="frasning-matning-fin">1400</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üßÆ</span> Avv. Volym (Q)</span>
                    <span class="result-value" id="frasning-avverkad-volym">144.5 cm¬≥/min</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">‚ö°</span> Effekt (Pc)</span>
                    <span class="result-value" id="frasning-effekt">3.61 kW</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üî©</span> Vridmoment (M)</span>
                    <span class="result-value" id="frasning-vridmoment">5.9 Nm</span>
                </div>
                </div>
        </div>

        <div id="planfrasning" class="tab-content">
            <div class="input-group">
                <div class="input-row">
                    <label class="label"><span class="icon">üè≠</span>Mat</label>
                    <select id="planfrasning-material">
                        <option value="mjukt" selected>Mjukt st√•l</option>
                        <option value="toolox44">Toolox 44</option>
                        <option value="hart">H√•rt st√•l</option>
                        <option value="aluminium">Aluminium</option>
                        <option value="rostfritt">Rostfritt st√•l</option>
                        <option value="hardat60">H√§rdat st√•l 60HRC</option>
                        <option value="plast">Plast</option>
                        <option value="koppar">Koppar</option>
                    </select>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚öôÔ∏è</span>Dia</label>
                    <input type="number" id="planfrasning-diameter" value="63" step="1" min="10">
                    <span class="unit">mm</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚ö°</span>Vc</label>
                    <input type="number" id="planfrasning-vc" value="" step="1" min="1" placeholder="Auto">
                    <span class="unit">m/min</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üî™</span>ap</label>
                    <input type="number" id="planfrasning-ap" value="1.5" step="0.1" min="0.1">
                    <span class="unit">mm</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üìê</span>Ingr</label>
                    <input type="number" id="planfrasning-ingrepp" value="80" step="1" min="1" max="100">
                    <span class="unit">% av D</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">ü¶∑</span>Z</label>
                    <input type="number" id="planfrasning-tander" value="6" step="1" min="1">
                    <span class="unit">st</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üçΩÔ∏è</span>fz</label>
                    <input type="number" id="planfrasning-fz" value="0.18" step="0.01" min="0.01">
                    <span class="unit">mm/t</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚öôÔ∏è</span>MaxN</label>
                    <input type="number" id="planfrasning-max-rpm" value="" step="10" min="1" placeholder="Valfritt">
                    <span class="unit">r/min</span>
                </div>
            </div>
            
            <div class="auto-calc">
                <div class="auto-row">
                    <span class="auto-label">üéØ Vc Auto</span>
                    <span class="auto-value" id="planfrasning-vcAuto">220</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">Kc (Spec. Kraft)</span>
                    <span class="auto-value" id="planfrasning-kc">1500 N/mm¬≤</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">‚öôÔ∏è fz-justering</span>
                    <span class="auto-value" id="planfrasning-justeringFz">100%</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">üîß fz Matningskorr.</span>
                    <span class="auto-value" id="planfrasning-fzJust">0.180</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">üìè Ingrepp (Korr)</span>
                    <span class="auto-value" id="planfrasning-ingreppsFaktor">1.00</span>
                </div>
            </div>
            <div class="results">
                <div class="result-item">
                    <span class="result-label"><span class="icon">‚öôÔ∏è</span> Varvtal</span>
                    <span class="result-value" id="planfrasning-varvtal">1114</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üöÄ</span> Matning</span>
                    <span class="result-value" id="planfrasning-matning">1198</span>
                </div>
                 <div class="result-item">
                    <span class="result-label"><span class="icon">üßÆ</span> Avv. Volym (Q)</span>
                    <span class="result-value" id="planfrasning-avverkad-volym">90.6 cm¬≥/min</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">‚ö°</span> Effekt (Pc)</span>
                    <span class="result-value" id="planfrasning-effekt">2.27 kW</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üî©</span> Vridmoment (M)</span>
                    <span class="result-value" id="planfrasning-vridmoment">19.4 Nm</span>
                </div>
                </div>
        </div>

        <div id="gangfrasning" class="tab-content">
            <div class="input-group">
                <div class="input-row">
                    <label class="label"><span class="icon">üè≠</span>Mat</label>
                    <select id="gangfrasning-material">
                        <option value="mjukt" selected>Mjukt st√•l</option>
                        <option value="toolox44">Toolox 44</option>
                        <option value="hart">H√•rt st√•l</option>
                        <option value="aluminium">Aluminium</option>
                        <option value="rostfritt">Rostfritt st√•l</option>
                        <option value="hardat60">H√§rdat st√•l 60HRC</option>
                        <option value="plast">Plast</option>
                        <option value="koppar">Koppar</option>
                    </select>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚öôÔ∏è</span>Dia</label>
                    <input type="number" id="gangfrasning-diameter" value="10" step="0.1" min="1">
                    <span class="unit">mm</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚ö°</span>Vc</label>
                    <input type="number" id="gangfrasning-vc" value="" step="1" min="1" placeholder="Auto">
                    <span class="unit">m/min</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üìê</span>Ingr</label>
                    <input type="number" id="gangfrasning-ingrepp" value="20" step="1" min="1" max="100">
                    <span class="unit">%</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">ü¶∑</span>Z</label>
                    <input type="number" id="gangfrasning-tander" value="3" step="1" min="1">
                    <span class="unit">st</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üçΩÔ∏è</span>fz</label>
                    <input type="number" id="gangfrasning-fz" value="0.08" step="0.01" min="0.01">
                    <span class="unit">mm/t</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚öôÔ∏è</span>MaxN</label>
                    <input type="number" id="gangfrasning-max-rpm" value="" step="10" min="1" placeholder="Valfritt">
                    <span class="unit">r/min</span>
                </div>
            </div>
            
            <div class="auto-calc">
                <div class="auto-row">
                    <span class="auto-label">üéØ Vc Auto</span>
                    <span class="auto-value" id="gangfrasning-vcAuto">85</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">Kc (Spec. Kraft)</span>
                    <span class="auto-value" id="gangfrasning-kc">1500 N/mm¬≤</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">‚öôÔ∏è fz-justering</span>
                    <span class="auto-value" id="gangfrasning-justeringFz">100%</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">üîß fz justerad</span>
                    <span class="auto-value" id="gangfrasning-fzJust">0.080</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">üìè Ingrepp</span>
                    <span class="auto-value" id="gangfrasning-ingreppsFaktor">1.67</span>
                </div>
            </div>
            <div class="results">
                <div class="result-item">
                    <span class="result-label"><span class="icon">‚öôÔ∏è</span> Varvtal</span>
                    <span class="result-value" id="gangfrasning-varvtal">2653</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üöÄ</span> Matning</span>
                    <span class="result-value" id="gangfrasning-matning">1053</span>
                </div>
                 <div class="result-item">
                    <span class="result-label"><span class="icon">‚ö°</span> Effekt (Pc)</span>
                    <span class="result-value" id="gangfrasning-effekt">~1.25 kW</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üî©</span> Vridmoment (M)</span>
                    <span class="result-value" id="gangfrasning-vridmoment">~4.5 Nm</span>
                </div>
                </div>
        </div>

        <div id="borrning" class="tab-content">
            <div class="input-group">
                <div class="input-row">
                    <label class="label"><span class="icon">üè≠</span>Mat</label>
                    <select id="borrning-material">
                        <option value="mjukt">Mjukt st√•l</option>
                        <option value="toolox44">Toolox 44</option>
                        <option value="hart" selected>H√•rt st√•l</option>
                        <option value="aluminium">Aluminium</option>
                        <option value="rostfritt">Rostfritt st√•l</option>
                        <option value="hardat60">H√§rdat st√•l 60HRC</option>
                        <option value="plast">Plast</option>
                        <option value="koppar">Koppar</option>
                    </select>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üìè</span>L√§ngd</label>
                    <select id="borrning-langd">
                        <option value="1-4">1-4√óD (140%)</option>
                        <option value="4-5" selected>4-5√óD (100%)</option>
                        <option value="5-8">5-8√óD (80%)</option>
                        <option value="8-12">8-12√óD (60%)</option>
                        <option value="12+">>12√óD (50%)</option>
                    </select>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚öôÔ∏è</span>Dia</label>
                    <input type="number" id="borrning-diameter" value="4.3" step="0.05" min="0.5">
                    <span class="unit">mm</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚ö°</span>Vc</label>
                    <input type="number" id="borrning-vc" value="" step="1" min="1" placeholder="Auto">
                    <span class="unit">m/min</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üçΩÔ∏è</span>f</label> <input type="number" id="borrning-f" value="" step="0.005" min="0.001" placeholder="Auto">
                    <span class="unit">mm/v</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚öôÔ∏è</span>MaxN</label>
                    <input type="number" id="borrning-max-rpm" value="" step="10" min="1" placeholder="Valfritt">
                    <span class="unit">r/min</span>
                </div>
            </div>
            <div class="auto-calc">
                <div class="auto-row">
                    <span class="auto-label">üéØ Vc Auto</span>
                    <span class="auto-value" id="borrning-vcAuto">45</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">Kc (Spec. Kraft)</span>
                    <span class="auto-value" id="borrning-kc">2500 N/mm¬≤</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">üîß f bas</span>
                    <span class="auto-value" id="borrning-fzBas">0.140</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">üìè Material</span>
                    <span class="auto-value" id="borrning-materialFaktor">80%</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">üìè L√§ngd</span>
                    <span class="auto-value" id="borrning-langdFaktor">100%</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">‚úÖ f justerad</span>
                    <span class="auto-value" id="borrning-fzJust">0.112</span>
                </div>
            </div>
            <div class="results">
                <div class="result-item">
                    <span class="result-label"><span class="icon">‚öôÔ∏è</span> Varvtal</span>
                    <span class="result-value" id="borrning-varvtal">3338</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üöÄ</span> Matning</span>
                    <span class="result-value" id="borrning-matning">374</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üßÆ</span> Avv. Volym (Q)</span>
                    <span class="result-value" id="borrning-avverkad-volym">5.5 cm¬≥/min</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">‚ö°</span> Effekt (Pc)</span>
                    <span class="result-value" id="borrning-effekt">0.23 kW</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üî©</span> Vridmoment (M)</span>
                    <span class="result-value" id="borrning-vridmoment">0.66 Nm</span>
                </div>
                </div>
        </div>

        <div id="brotschning" class="tab-content">
            <div class="input-group">
                <div class="input-row">
                    <label class="label"><span class="icon">üè≠</span>Mat</label>
                    <select id="brotschning-material">
                        <option value="mjukt" selected>Mjukt st√•l</option>
                        <option value="toolox44">Toolox 44</option>
                        <option value="hart">H√•rt st√•l</option>
                        <option value="aluminium">Aluminium</option>
                        <option value="rostfritt">Rostfritt st√•l</option>
                        <option value="hardat60">H√§rdat st√•l 60HRC</option>
                        <option value="plast">Plast</option>
                        <option value="koppar">Koppar</option>
                    </select>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚öôÔ∏è</span>Dia</label>
                    <input type="number" id="brotschning-diameter" value="10" step="0.1" min="1">
                    <span class="unit">mm</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚ö°</span>Vc</label>
                    <input type="number" id="brotschning-vc" value="" step="1" min="1" placeholder="Auto">
                    <span class="unit">m/min</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">ü¶∑</span>Z</label>
                    <input type="number" id="brotschning-tander" value="6" step="1" min="4">
                    <span class="unit">st</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üçΩÔ∏è</span>fz</label>
                    <input type="number" id="brotschning-fz" value="" step="0.005" min="0.001" placeholder="Auto">
                    <span class="unit">mm/t</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚öôÔ∏è</span>MaxN</label>
                    <input type="number" id="brotschning-max-rpm" value="" step="10" min="1" placeholder="Valfritt">
                    <span class="unit">r/min</span>
                </div>
            </div>
            
            <div class="auto-calc">
                <div class="auto-row">
                    <span class="auto-label">üéØ Vc Auto</span>
                    <span class="auto-value" id="brotschning-vcAuto">130</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">üîß fz bas</span>
                    <span class="auto-value" id="brotschning-fzBas">0.060</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">üìè Material</span>
                    <span class="auto-value" id="brotschning-materialFaktor">100%</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">‚úÖ fz justerad</span>
                    <span class="auto-value" id="brotschning-fzJust">0.060</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">‚¨áÔ∏è Rek. Borr Dia</span>
                    <span class="auto-value" id="brotschning-borrDia">9.80 mm</span>
                </div>
            </div>
            <div class="results">
                <div class="result-item">
                    <span class="result-label"><span class="icon">‚öôÔ∏è</span> Varvtal</span>
                    <span class="result-value" id="brotschning-varvtal">4138</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üöÄ</span> Matning</span>
                    <span class="result-value" id="brotschning-matning">1489</span>
                </div>
            </div>
        </div>
        
        <div id="svarvning" class="tab-content">
            <div class="input-group">
                <div class="input-row">
                    <label class="label"><span class="icon">üè≠</span>Mat</label>
                    <select id="svarvning-material">
                        <option value="mjukt" selected>Mjukt st√•l</option>
                        <option value="toolox44">Toolox 44</option>
                        <option value="hart">H√•rt st√•l</option>
                        <option value="aluminium">Aluminium</option>
                        <option value="rostfritt">Rostfritt st√•l</option>
                        <option value="hardat60">H√§rdat st√•l 60HRC</option>
                        <option value="plast">Plast</option>
                        <option value="koppar">Koppar</option>
                    </select>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚öôÔ∏è</span>Dia</label>
                    <input type="number" id="svarvning-diameter" value="50" step="1" min="1">
                    <span class="unit">mm</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚ö°</span>Vc</label>
                    <input type="number" id="svarvning-vc" value="" step="1" min="1" placeholder="Auto">
                    <span class="unit">m/min</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üî™</span>ap</label>
                    <input type="number" id="svarvning-ap" value="2.0" step="0.1" min="0.1">
                    <span class="unit">mm</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">üçΩÔ∏è</span>f</label>
                    <input type="number" id="svarvning-f" value="0.25" step="0.01" min="0.01">
                    <span class="unit">mm/v</span>
                </div>
                <div class="input-row">
                    <label class="label"><span class="icon">‚öôÔ∏è</span>MaxN</label>
                    <input type="number" id="svarvning-max-rpm" value="" step="10" min="1" placeholder="Valfritt">
                    <span class="unit">r/min</span>
                </div>
            </div>
            
            <div class="auto-calc">
                <div class="auto-row">
                    <span class="auto-label">üéØ Vc Auto</span>
                    <span class="auto-value" id="svarvning-vcAuto">250</span>
                </div>
                <div class="auto-row">
                    <span class="auto-label">Kc (Spec. Kraft)</span>
                    <span class="auto-value" id="svarvning-kc">1500 N/mm¬≤</span>
                </div>
            </div>
            <div class="results">
                <div class="result-item">
                    <span class="result-label"><span class="icon">‚öôÔ∏è</span> Varvtal</span>
                    <span class="result-value" id="svarvning-varvtal">1592</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üöÄ</span> Matning (Vf)</span>
                    <span class="result-value" id="svarvning-matning">398</span>
                </div>
                 <div class="result-item">
                    <span class="result-label"><span class="icon">üßÆ</span> Avv. Volym (Q)</span>
                    <span class="result-value" id="svarvning-avverkad-volym">75.0 cm¬≥/min</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">‚ö°</span> Effekt (Pc)</span>
                    <span class="result-value" id="svarvning-effekt">1.88 kW</span>
                </div>
                <div class="result-item">
                    <span class="result-label"><span class="icon">üî©</span> Vridmoment (M)</span>
                    <span class="result-value" id="svarvning-vridmoment">11.3 Nm</span>
                </div>
            </div>
        </div>
        <div class="tips-container">
            <div class="tips-header" onclick="toggleTipsBox()">
                <h3>üí° Tips & Optimering <span id="tips-toggle-icon">+</span></h3>
            </div>
            <div class="tips-content" id="tips-content-container">
                </div>
        </div>

        <button class="reset-btn" onclick="resetAll()">üîÑ √Öterst√§ll alla</button>
    </div>

    <script>
        // NY KORRIGERAD FZ-TABELL (mer progressiv √∂kning)
        const frasningFzTabell = {
            0.5: 0.005, 1.0: 0.008, 1.5: 0.010, 2.0: 0.012, 2.5: 0.015,
            3.0: 0.018, 4.0: 0.022, 5.0: 0.028, 6.0: 0.035, 8.0: 0.045,
            10.0: 0.055, 12.0: 0.060, 14.0: 0.068, 16.0: 0.075, 18.0: 0.088,
            20.0: 0.095, 25.0: 0.120
        };
        
        // Specifik Sk√§rkraft (kc) i N/mm¬≤ - Grova uppskattningar f√∂r ber√§kning av Effekt (Pc)
        const kcData = {
            mjukt: 1500, toolox44: 2000, hart: 2500, aluminium: 500, rostfritt: 2200, hardat60: 3000, plast: 100, koppar: 700
        };

        // --- DATA F√ñR FR√ÑSNING / PLANFR√ÑSNING ---
        const frasningData = {
            mjukt: { vcAuto: 220, justering: 100, kc: kcData.mjukt },
            toolox44: { vcAuto: 110, justering: 85, kc: kcData.toolox44 },
            hart: { vcAuto: 160, justering: 80, kc: kcData.hart },
            aluminium: { vcAuto: 400, justering: 100, kc: kcData.aluminium },
            rostfritt: { vcAuto: 120, justering: 80, kc: kcData.rostfritt },
            hardat60: { vcAuto: 60, justering: 60, kc: kcData.hardat60 },
            plast: { vcAuto: 450, justering: 100, kc: kcData.plast },
            koppar: { vcAuto: 350, justering: 100, kc: kcData.koppar }
        };
        const planfrasningData = frasningData; 

        // --- DATA F√ñR G√ÑNGFR√ÑSNING ---
        const gangfrasningData = {
            mjukt: { vcAuto: 85, justering: 100, kc: kcData.mjukt },
            toolox44: { vcAuto: 70, justering: 85, kc: kcData.toolox44 },
            hart: { vcAuto: 55, justering: 80, kc: kcData.hart },
            aluminium: { vcAuto: 250, justering: 100, kc: kcData.aluminium },
            rostfritt: { vcAuto: 40, justering: 80, kc: kcData.rostfritt },
            hardat60: { vcAuto: 20, justering: 60, kc: kcData.hardat60 },
            plast: { vcAuto: 300, justering: 100, kc: kcData.plast },
            koppar: { vcAuto: 120, justering: 100, kc: kcData.koppar }
        };

        // --- DATA F√ñR BORRNING ---
        const borrningData = {
            mjukt: { vcAuto: 90, fzMaterial: 100, kc: kcData.mjukt }, 
            toolox44: { vcAuto: 60, fzMaterial: 85, kc: kcData.toolox44 }, 
            hart: { vcAuto: 45, fzMaterial: 80, kc: kcData.hart }, 
            aluminium: { vcAuto: 200, fzMaterial: 100, kc: kcData.aluminium }, 
            rostfritt: { vcAuto: 35, fzMaterial: 80, kc: kcData.rostfritt }, 
            hardat60: { vcAuto: 20, fzMaterial: 60, kc: kcData.hardat60 }, 
            plast: { vcAuto: 80, fzMaterial: 120, kc: kcData.plast },
            koppar: { vcAuto: 100, fzMaterial: 100, kc: kcData.koppar }
        };

        const fzBorrTabell = [
            { dia: 1.0, fz: 0.070 }, 
            { dia: 2.0, fz: 0.095 }, 
            { dia: 3.0, fz: 0.120 }, 
            { dia: 4.0, fz: 0.140 }, // Justerat fz f√∂r 4mm
            { dia: 5.0, fz: 0.165 }, 
            { dia: 13.0, fz: 0.340 }, 
            { dia: 14.0, fz: 0.360 }, 
            { dia: 20.0, fz: 0.450 } 
        ];

        const borrLangdFaktorer = { '1-4': 140, '4-5': 100, '5-8': 80, '8-12': 60, '12+': 50 };

        // --- DATA F√ñR BROTSCHNING ---
        const brotschningData = {
            mjukt: { vcAuto: 130, fzMaterial: 100, kc: kcData.mjukt },
            toolox44: { vcAuto: 80, fzMaterial: 85, kc: kcData.toolox44 },
            hart: { vcAuto: 80, fzMaterial: 80, kc: kcData.hart },
            aluminium: { vcAuto: 250, fzMaterial: 100, kc: kcData.aluminium },
            rostfritt: { vcAuto: 65, fzMaterial: 75, kc: kcData.rostfritt },
            hardat60: { vcAuto: 30, fzMaterial: 60, kc: kcData.hardat60 },
            plast: { vcAuto: 150, fzMaterial: 100, kc: kcData.plast },
            koppar: { vcAuto: 180, fzMaterial: 100, kc: kcData.koppar }
        };

        const fzBrotschTabell = [
            { dia: 1.0, fz: 0.015 },
            { dia: 2.0, fz: 0.025 },
            { dia: 4.0, fz: 0.035 },
            { dia: 6.0, fz: 0.045 },
            { dia: 10.0, fz: 0.060 },
            { dia: 16.0, fz: 0.080 },
            { dia: 20.0, fz: 0.090 }
        ];

         // --- DATA F√ñR SVARVNING --- (NY)
        const svarvningData = {
            mjukt: { vcAuto: 250, kc: kcData.mjukt },
            toolox44: { vcAuto: 150, kc: kcData.toolox44 },
            hart: { vcAuto: 200, kc: kcData.hart },
            aluminium: { vcAuto: 500, kc: kcData.aluminium },
            rostfritt: { vcAuto: 180, kc: kcData.rostfritt },
            hardat60: { vcAuto: 100, kc: kcData.hardat60 },
            plast: { vcAuto: 400, kc: kcData.plast },
            koppar: { vcAuto: 300, kc: kcData.koppar }
        };
        // ---------------------------------
        
        const FINISH_FACTOR = 1.05; 

        // --- TIPS INNEH√ÖLL (Unikt f√∂r varje flik) ---
        const uniqueTips = {
            frasning: `
                <div class="tip-category">
                    <strong>Sk√§rv√§tska & Kylning</strong>
                    <ul>
                        <li><span class="good">G√∂r:</span> Anv√§nd **h√∂gtryckskylning** (intern kylning) f√∂r att effektivt f√• bort sp√•nor i djupa fickor eller sp√•r.</li>
                        <li><span class="bad">Undvik:</span> Att sn√•lk√∂ra med kylv√§tska i rostfritt st√•l - det orsakar yth√§rdning.</li>
                    </ul>
                </div>
                <div class="tip-category">
                    <strong>Verktygsstrategi</strong>
                    <ul>
                        <li><span class="good">G√∂r:</span> Anv√§nd **Medfr√§sning** (Climb Milling) f√∂r b√§ttre yta, l√§ngre verktygsliv och minimalt glapp i maskinen.</li>
                        <li><span class="good">G√∂r:</span> F√∂rl√§ng verktygslivsl√§ngden genom att bibeh√•lla konstant **sp√•ntjocklek** (anv√§nd l√•g radiell inmatning (ae), h√∂g matning (Vf) - Trokoidal fr√§sning).</li>
                        <li><span class="bad">Undvik:</span> F√∂r l√•ngt **utligg** p√• verktyget; det √§r den st√∂rsta orsaken till vibrationer och eggslitage. H√•ll utligg < 3x Diameter.</li>
                    </ul>
                </div>
            `,
            planfrasning: `
                <div class="tip-category">
                    <strong>Ytkvalitet & Stabilitet</strong>
                    <ul>
                        <li><span class="good">G√∂r:</span> Anv√§nd h√∂ga fz-v√§rden vid h√∂gt ingrepp. Chip Thinning effekten √§r l√•g vid h√∂g radiell ingrepp.</li>
                        <li><span class="good">G√∂r:</span> Se till att fr√§sens centrumlinje √§r n√•got f√∂rskjuten fr√•n mitten av ytan.</li>
                        <li><span class="bad">Undvik:</span> Att k√∂ra med f√∂r liten fr√§sdiameter i f√∂rh√•llande till arbetsstyckets bredd (ideal ae/D 60-80% f√∂r max materialavverkning).</li>
                    </ul>
                </div>
                <div class="tip-category">
                    <strong>Maskinkraft</strong>
                    <ul>
                        <li><span class="good">G√∂r:</span> V√§lj fr√§sar med **fin tanddelning** (close pitch) f√∂r maximal produktivitet p√• maskiner med begr√§nsad effekt.</li>
                        <li><span class="good">G√∂r:</span> Kontrollera Pc (Effekt) f√∂r att s√§kerst√§lla att spindeln inte √∂verbelastas vid h√∂ga Q-v√§rden.</li>
                    </ul>
                </div>
            `,
            gangfrasning: `
                <div class="tip-category">
                    <strong>Process√§kerhet</strong>
                    <ul>
                        <li><span class="good">G√∂r:</span> Anv√§nd **cirkul√§r rampning** (mjuk in- och utg√•ng) i materialet f√∂r att minska sp√•npackning.</li>
                        <li><span class="good">G√∂r:</span> Styr alltid med **X/Y/Z-axlarna samtidigt** f√∂r att f√• r√§tt g√§ngstigning.</li>
                        <li><span class="bad">Undvik:</span> Raka/h√•rda ing√•ngar i materialet; detta kan ge vibrationer och skada de f√∂rsta t√§nderna.</li>
                    </ul>
                </div>
                <div class="tip-category">
                    <strong>Sk√§rdata</strong>
                    <ul>
                        <li><span class="good">G√∂r:</span> Anv√§nd **liten matning per tand (fz)**, speciellt i h√•rda material, f√∂r att f√∂rl√§nga verktygslivsl√§ngden.</li>
                        <li><span class="bad">Undvik:</span> Att g√§ngfr√§sa stora diametrar med f√∂r sm√• verktyg (D-fr√§s < 1/3 D-g√§nga).</li>
                    </ul>
                </div>
            `,
            borrning: `
                <div class="tip-category">
                    <strong>Sp√•nhantering & Kylning</strong>
                    <ul>
                        <li><span class="good">G√∂r:</span> Anv√§nd **inre kylning** (IK) vid h√•ldjup >4xD f√∂r att garantera sp√•navg√•ng.</li>
                        <li><span class="good">G√∂r:</span> Anv√§nd en stabiliserande **pilotborr** (centrumtappborr) innan djupare borrning p√• oregelbundna ytor.</li>
                        <li><span class="bad">Undvik:</span> **Hackspettsmetod** (Peck drilling) vid borrning med moderna solida h√•rdmetallborrar, om du inte har problem med sp√•navg√•ng (det tar on√∂digt l√•ng tid).</li>
                    </ul>
                </div>
                <div class="tip-category">
                    <strong>Rigiditet</strong>
                    <ul>
                        <li><span class="good">G√∂r:</span> Anv√§nd s√• **kort borr** som m√∂jligt f√∂r att maximera stabiliteten och rakheten.</li>
                        <li><span class="bad">Undvik:</span> Att borra i ytor som inte √§r vinkelr√§ta mot borrens axel (orsakar avb√∂jning).</li>
                    </ul>
                </div>
            `,
            brotschning: `
                <div class="tip-category">
                    <strong>Kvalitet & Tolerans</strong>
                    <ul>
                        <li><span class="good">G√∂r:</span> Anv√§nd en **underdimensionerad** f√∂rborr (0.1-0.4 mm mindre) f√∂r att s√§kerst√§lla att brotschen avverkar material och ger b√§sta yta.</li>
                        <li><span class="good">G√∂r:</span> Anv√§nd **l√•gt varvtal (Vc)** men **h√∂g matning (Vf)** j√§mf√∂rt med borrning, f√∂r att f√• ett rent snitt.</li>
                        <li><span class="bad">Undvik:</span> F√∂r stora f√∂rborrade h√•l, vilket leder till d√•lig ytkvalitet och snabbare brotschslitage.</li>
                    </ul>
                </div>
                <div class="tip-category">
                    <strong>F√∂rberedelse</strong>
                    <ul>
                        <li><span class="good">G√∂r:</span> Se till att maskinuppsp√§nningen √§r extremt **styv** och att brotschen √§r korrekt uppsp√§nd (minimalt kast).</li>
                        <li><span class="bad">Undvik:</span> Att stoppa rotationen i h√•let, backa ut med bibeh√•llen rotation.</li>
                    </ul>
                </div>
            `,
            svarvning: `
                <div class="tip-category">
                    <strong>Ytkvalitet & Sp√•nkontroll</strong>
                    <ul>
                        <li><span class="good">G√∂r:</span> V√§lj en **n√§sradie (r)** som √§r 2-3 g√•nger st√∂rre √§n matningen ($f$) f√∂r b√§sta ytkvalitet.</li>
                        <li><span class="good">G√∂r:</span> Anv√§nd **sp√•nbrytare** som matchar sk√§rdjupet ($a_p$) f√∂r att undvika l√•nga, trassliga sp√•nor.</li>
                        <li><span class="bad">Undvik:</span> L√•ga $V_c$ i rostfritt st√•l (kan orsaka vibrationer och eggslitage).</li>
                    </ul>
                </div>
                <div class="tip-category">
                    <strong>Effektivitet & Stabilitet</strong>
                    <ul>
                        <li><span class="good">G√∂r:</span> Anv√§nd h√∂g matning ($f$) och m√•ttligt sk√§rdjup ($a_p$) f√∂r att optimera sp√•ntjockleken.</li>
                        <li><span class="good">G√∂r:</span> Kontrollera **Effekt (Pc)** innan grovbearbetning f√∂r att s√§kerst√§lla att maskinen klarar avverkningen.</li>
                        <li><span class="bad">Undvik:</span> F√∂r l√•ngt utligg p√• verktyget (risk f√∂r vibrationer).</li>
                    </ul>
                </div>
            `
        };


        /**
         * Ber√§knar ingreppsfaktorn (Chip Thinning Factor) baserat p√• ae/D i procent.
         * Formeln √§r baserad p√• sin(arccos(1-2*ae/D)).
         * @param {number} aeD - Radiellt ingrepp i procent (1 till 100).
         * @returns {number} Ingreppsfaktor (IF).
         */
        function getIngreppsFaktor(aeD) {
            const ae_D_ratio = aeD / 100;
            
            // Hantera 100% ingrepp och √∂ver. Planfr√§sning med stort ingrepp har minimal chip thinning.
            if (ae_D_ratio >= 0.95) return 1.00; 
            
            const angle = Math.acos(1 - 2 * ae_D_ratio);
            const IF = 1 / Math.sin(angle);
            
            return IF; 
        }

        // INTERPOLATION F√ñR FZ
        function interpolateFzTable(diameter, table) {
            let lower = table[0], upper = table[0];
            for (let i = 0; i < table.length; i++) {
                if (table[i].dia <= diameter) lower = table[i];
                if (table[i].dia >= diameter) { upper = table[i]; break; }
            }
            if (lower.dia === upper.dia) return lower.fz;
            
            const ratio = (diameter - lower.dia) / (upper.dia - lower.dia);
            return lower.fz + (upper.fz - lower.fz) * ratio;
        }

        function getFrasningFz(diameter) {
             const D = Math.round(diameter * 2) / 2;
            const keys = Object.keys(frasningFzTabell).map(Number).sort((a, b) => a - b);
            
            if (frasningFzTabell[D]) return frasningFzTabell[D];
            
            const simpleTable = keys.map(k => ({ dia: k, fz: frasningFzTabell[k] }));
            return interpolateFzTable(diameter, simpleTable);
        }

        function getBrotschFzBas(diameter) {
            return interpolateFzTable(diameter, fzBrotschTabell);
        }

        function getPreDrillDiameter(D) {
            if (D < 5) return D - 0.1;
            if (D <= 10) return D - 0.2;
            if (D <= 20) return D - 0.3;
            return D - 0.4;
        }

        function setFrasningFzByDiameter() {
            const D = parseFloat(document.getElementById('frasning-diameter').value) || 12;
            const fz = getFrasningFz(D);
            document.getElementById('frasning-fz').value = fz.toFixed(3);
            calculateFrasning();
        }

        function calculateFrasning() {
            const D = parseFloat(document.getElementById('frasning-diameter').value) || 12;
            const vcInput = document.getElementById('frasning-vc').value.trim();
            const ap = parseFloat(document.getElementById('frasning-ap').value) || 5; // NY AP
            const aeD = parseFloat(document.getElementById('frasning-ingrepp').value) || 10;
            const Z = parseInt(document.getElementById('frasning-tander').value) || 4;
            const fzInput = parseFloat(document.getElementById('frasning-fz').value) || 0.060;
            const materialKey = document.getElementById('frasning-material').value;
            const maxRpmInput = document.getElementById('frasning-max-rpm').value.trim(); 
            
            const material = frasningData[materialKey] || { justering: 100, vcAuto: 220, kc: kcData.mjukt };
            const Vc = vcInput ? parseFloat(vcInput) : material.vcAuto;
            const kc = material.kc; // NY KC

            const justeringFz = material.justering / 100;
            
            const fzMaterialAdjusted = fzInput * justeringFz; 
            const IF = getIngreppsFaktor(aeD);
            const fzMachineFeed_Grov = fzMaterialAdjusted * IF; 
            
            const n_theoretic = (Vc * 1000) / (Math.PI * D);

            let n_final;
            if (maxRpmInput && parseFloat(maxRpmInput) > 0) {
                const N_Max = parseFloat(maxRpmInput);
                n_final = Math.min(n_theoretic, N_Max);
            } else {
                n_final = n_theoretic;
            }

            const Vf_Grov = fzMachineFeed_Grov * n_final * Z;
            const Vf_Fin = fzMaterialAdjusted * n_final * Z * FINISH_FACTOR;

            // NYA BER√ÑKNINGAR (Avverkad Volym, Effekt, Vridmoment)
            const ae_mm = D * aeD / 100; // Radiellt ingrepp i mm
            const Q_mm3 = ap * ae_mm * Vf_Grov; // mm¬≥/min
            const Q_cm3 = Q_mm3 / 1000; // cm¬≥/min

            // Effekt Pc (Pc = Q_mm3 * kc / (60 * 10^6))
            const Pc = (Q_mm3 * kc) / (60 * 1000 * 1000); 

            // Vridmoment M (M = Pc * 9550 / N)
            const M_Nm = (Pc * 9550) / n_final;

            document.getElementById('frasning-vcAuto').textContent = material.vcAuto;
            document.getElementById('frasning-kc').textContent = kc.toFixed(0) + ' N/mm¬≤'; // NY KC
            document.getElementById('frasning-justeringFz').textContent = material.justering + '%';
            document.getElementById('frasning-fzJust').textContent = fzMachineFeed_Grov.toFixed(3);
            document.getElementById('frasning-ingreppsFaktor').textContent = IF.toFixed(2);
            document.getElementById('frasning-varvtal').textContent = Math.round(n_final);
            document.getElementById('frasning-matning-grov').textContent = Math.round(Vf_Grov);
            document.getElementById('frasning-matning-fin').textContent = Math.round(Vf_Fin); 
            // NYA RESULTAT
            document.getElementById('frasning-avverkad-volym').textContent = Q_cm3.toFixed(1) + ' cm¬≥/min';
            document.getElementById('frasning-effekt').textContent = Pc.toFixed(2) + ' kW';
            document.getElementById('frasning-vridmoment').textContent = M_Nm.toFixed(1) + ' Nm';
        }
        
        function calculatePlanfrasning() {
            const D = parseFloat(document.getElementById('planfrasning-diameter').value) || 63;
            const vcInput = document.getElementById('planfrasning-vc').value.trim();
            const ap = parseFloat(document.getElementById('planfrasning-ap').value) || 1.5; // NY AP
            const Z = parseInt(document.getElementById('planfrasning-tander').value) || 6; 
            const fzInput = parseFloat(document.getElementById('planfrasning-fz').value) || 0.18;
            const materialKey = document.getElementById('planfrasning-material').value;
            const maxRpmInput = document.getElementById('planfrasning-max-rpm').value.trim(); 
            
            const aeD = parseFloat(document.getElementById('planfrasning-ingrepp').value) || 80; 
            const IF = getIngreppsFaktor(aeD); 
            
            const material = planfrasningData[materialKey] || { justering: 100, vcAuto: 220, kc: kcData.mjukt };
            const Vc = vcInput ? parseFloat(vcInput) : material.vcAuto;
            const kc = material.kc; // NY KC
            
            const justeringFz = material.justering / 100;
            
            const IF_final = Math.max(1.0, IF); // Chip thinning √§r irrelevant vid stort ingrepp
            
            const fzMaterialAdjusted = fzInput * justeringFz; 
            const fzMachineFeed = fzMaterialAdjusted * IF_final; 
            
            const n_theoretic = (Vc * 1000) / (Math.PI * D);

            let n_final;
            if (maxRpmInput && parseFloat(maxRpmInput) > 0) {
                const N_Max = parseFloat(maxRpmInput);
                n_final = Math.min(n_theoretic, N_Max);
            } else {
                n_final = n_theoretic;
            }

            const Vf = fzMachineFeed * n_final * Z;
            
            // NYA BER√ÑKNINGAR (Avverkad Volym, Effekt, Vridmoment)
            const ae_mm = D * aeD / 100; // Radiellt ingrepp i mm
            const Q_mm3 = ap * ae_mm * Vf; // mm¬≥/min
            const Q_cm3 = Q_mm3 / 1000; // cm¬≥/min

            // Effekt Pc (Pc = Q_mm3 * kc / (60 * 10^6))
            const Pc = (Q_mm3 * kc) / (60 * 1000 * 1000); 

            // Vridmoment M (M = Pc * 9550 / N)
            const M_Nm = (Pc * 9550) / n_final;


            document.getElementById('planfrasning-vcAuto').textContent = material.vcAuto;
            document.getElementById('planfrasning-kc').textContent = kc.toFixed(0) + ' N/mm¬≤'; // NY KC
            document.getElementById('planfrasning-justeringFz').textContent = material.justering + '%';
            document.getElementById('planfrasning-fzJust').textContent = fzMachineFeed.toFixed(3);
            document.getElementById('planfrasning-ingreppsFaktor').textContent = IF_final.toFixed(2);
            document.getElementById('planfrasning-varvtal').textContent = Math.round(n_final);
            document.getElementById('planfrasning-matning').textContent = Math.round(Vf); 
            // NYA RESULTAT
            document.getElementById('planfrasning-avverkad-volym').textContent = Q_cm3.toFixed(1) + ' cm¬≥/min';
            document.getElementById('planfrasning-effekt').textContent = Pc.toFixed(2) + ' kW';
            document.getElementById('planfrasning-vridmoment').textContent = M_Nm.toFixed(1) + ' Nm';
        }

        function calculateBorrning() {
            const D = parseFloat(document.getElementById('borrning-diameter').value) || 4.3;
            const vcInput = document.getElementById('borrning-vc').value.trim();
            const fInput = document.getElementById('borrning-f').value.trim(); // NYTT INPUT F√ÑLT
            const materialKey = document.getElementById('borrning-material').value;
            const langdKey = document.getElementById('borrning-langd').value;
            const maxRpmInput = document.getElementById('borrning-max-rpm').value.trim(); 
            
            const material = borrningData[materialKey];
            const langdFaktor = borrLangdFaktorer[langdKey] / 100;
            const materialFaktor = material.fzMaterial / 100;
            
            const Vc = vcInput ? parseFloat(vcInput) : material.vcAuto;
            const kc = material.kc; // NY KC

            const fzBas = interpolateFzTable(D, fzBorrTabell);
            
            let f_to_use;
            let fzJust = fzBas * materialFaktor * langdFaktor;
            
            if (fInput) {
                f_to_use = parseFloat(fInput);
            } else {
                f_to_use = fzJust;
            }
            
            const n_theoretic = (Vc * 1000) / (Math.PI * D);

            let n_final;
            if (maxRpmInput && parseFloat(maxRpmInput) > 0) {
                const N_Max = parseFloat(maxRpmInput);
                n_final = Math.min(n_theoretic, N_Max);
            } else {
                n_final = n_theoretic;
            }

            const Vf = f_to_use * n_final;

            // NYA BER√ÑKNINGAR (Avverkad Volym, Effekt, Vridmoment)
            const A_mm2 = (Math.PI * D * D) / 4; // Borryta (mm¬≤)
            const Q_mm3 = A_mm2 * Vf; // mm¬≥/min
            const Q_cm3 = Q_mm3 / 1000; // cm¬≥/min

            // Effekt Pc (Pc = Q_mm3 * kc / (60 * 10^6)) - grov uppskattning, ignorerar borrgeometri
            const Pc = (Q_mm3 * kc) / (60 * 1000 * 1000); 

            // Vridmoment M (M = Pc * 9550 / N)
            const M_Nm = (Pc * 9550) / n_final;


            document.getElementById('borrning-vcAuto').textContent = material.vcAuto;
            document.getElementById('borrning-kc').textContent = kc.toFixed(0) + ' N/mm¬≤'; // NY KC
            document.getElementById('borrning-fzBas').textContent = fzBas.toFixed(3);
            document.getElementById('borrning-materialFaktor').textContent = material.fzMaterial + '%';
            document.getElementById('borrning-langdFaktor').textContent = borrLangdFaktorer[langdKey] + '%';
            document.getElementById('borrning-fzJust').textContent = fzJust.toFixed(3);

            // UPPDATERA INPUT F√ÑLTET (OM TOMT)
            if (!fInput) {
                document.getElementById('borrning-f').value = f_to_use.toFixed(3);
            }
            
            document.getElementById('borrning-varvtal').textContent = Math.round(n_final);
            document.getElementById('borrning-matning').textContent = Math.round(Vf);
            
            // NYA RESULTAT
            document.getElementById('borrning-avverkad-volym').textContent = Q_cm3.toFixed(1) + ' cm¬≥/min';
            document.getElementById('borrning-effekt').textContent = Pc.toFixed(2) + ' kW';
            document.getElementById('borrning-vridmoment').textContent = M_Nm.toFixed(2) + ' Nm';
        }

        function calculateGangfrasning() {
            const D = parseFloat(document.getElementById('gangfrasning-diameter').value) || 10;
            const vcInput = document.getElementById('gangfrasning-vc').value.trim();
            const aeD = parseFloat(document.getElementById('gangfrasning-ingrepp').value) || 20;
            const Z = parseInt(document.getElementById('gangfrasning-tander').value) || 3;
            const fzInput = parseFloat(document.getElementById('gangfrasning-fz').value) || 0.08;
            const materialKey = document.getElementById('gangfrasning-material').value;
            const maxRpmInput = document.getElementById('gangfrasning-max-rpm').value.trim();
            
            const material = gangfrasningData[materialKey] || { justering: 100, vcAuto: 85, kc: kcData.mjukt };
            const Vc = vcInput ? parseFloat(vcInput) : material.vcAuto;
            const kc = material.kc; // NY KC

            const justeringFz = material.justering / 100;
            const fzJust = fzInput * justeringFz; 
            const IF = getIngreppsFaktor(aeD); 
            
            const n_theoretic = (Vc * 1000) / (Math.PI * D);

            let n_final;
            if (maxRpmInput && parseFloat(maxRpmInput) > 0) {
                const N_Max = parseFloat(maxRpmInput);
                n_final = Math.min(n_theoretic, N_Max);
            } else {
                n_final = n_theoretic;
            }

            const Vf = (fzJust * IF) * n_final * Z; 

            // NYA BER√ÑKNINGAR (Grov uppskattning)
            // Anv√§nder en nominell ap=5mm och ae=100% f√∂r att f√• en grov uppskattning av kraft
            const ap_nominal = 5; 
            const ae_mm_nominal = D; 
            const Q_mm3_nominal = ap_nominal * ae_mm_nominal * Vf;
            const Pc = (Q_mm3_nominal * kc) / (60 * 1000 * 1000); 
            const M_Nm = (Pc * 9550) / n_final;


            document.getElementById('gangfrasning-vcAuto').textContent = material.vcAuto;
            document.getElementById('gangfrasning-kc').textContent = kc.toFixed(0) + ' N/mm¬≤'; // NY KC
            document.getElementById('gangfrasning-justeringFz').textContent = material.justering + '%';
            document.getElementById('gangfrasning-fzJust').textContent = fzJust.toFixed(3); 
            document.getElementById('gangfrasning-ingreppsFaktor').textContent = IF.toFixed(2);
            document.getElementById('gangfrasning-varvtal').textContent = Math.round(n_final);
            document.getElementById('gangfrasning-matning').textContent = Math.round(Vf);

            document.getElementById('gangfrasning-effekt').textContent = '~' + Pc.toFixed(2) + ' kW';
            document.getElementById('gangfrasning-vridmoment').textContent = '~' + M_Nm.toFixed(1) + ' Nm';
        }

        function calculateBrotschning() {
            const D = parseFloat(document.getElementById('brotschning-diameter').value) || 10;
            const vcInput = document.getElementById('brotschning-vc').value.trim();
            const Z = parseInt(document.getElementById('brotschning-tander').value) || 6;
            const fzInput = document.getElementById('brotschning-fz').value.trim();
            const materialKey = document.getElementById('brotschning-material').value;
            const maxRpmInput = document.getElementById('brotschning-max-rpm').value.trim(); 
            
            const material = brotschningData[materialKey];
            const materialFaktor = material.fzMaterial / 100;
            
            const Vc = vcInput ? parseFloat(vcInput) : material.vcAuto;
            
            const fzBas = getBrotschFzBas(D);
            let fzJust = fzBas * materialFaktor;

            let fz_to_use;
            if (fzInput) {
                fz_to_use = parseFloat(fzInput);
            } else {
                fz_to_use = fzJust;
            }
            
            const n_theoretic = (Vc * 1000) / (Math.PI * D);

            let n_final;
            if (maxRpmInput && parseFloat(maxRpmInput) > 0) {
                const N_Max = parseFloat(maxRpmInput);
                n_final = Math.min(n_theoretic, N_Max);
            } else {
                n_final = n_theoretic;
            }

            const Vf = fz_to_use * n_final * Z;

            const preDrillD = getPreDrillDiameter(D);

            document.getElementById('brotschning-vcAuto').textContent = material.vcAuto;
            document.getElementById('brotschning-fzBas').textContent = fzBas.toFixed(3);
            document.getElementById('brotschning-materialFaktor').textContent = material.fzMaterial + '%';
            document.getElementById('brotschning-fzJust').textContent = fzJust.toFixed(3);

            // UPPDATERA INPUT F√ÑLTET (OM TOMT)
            if (!fzInput) {
                document.getElementById('brotschning-fz').value = fz_to_use.toFixed(3);
            }

            document.getElementById('brotschning-varvtal').textContent = Math.round(n_final);
            document.getElementById('brotschning-matning').textContent = Math.round(Vf);
            document.getElementById('brotschning-borrDia').textContent = preDrillD.toFixed(2) + ' mm';
        }
        
        // NY FUNKTION F√ñR SVARVNING
        function calculateSvarvning() {
            const D = parseFloat(document.getElementById('svarvning-diameter').value) || 50;
            const vcInput = document.getElementById('svarvning-vc').value.trim();
            const f = parseFloat(document.getElementById('svarvning-f').value) || 0.25; // Matning f (mm/v)
            const ap = parseFloat(document.getElementById('svarvning-ap').value) || 2.0; // Sk√§rdjup ap (mm)
            const materialKey = document.getElementById('svarvning-material').value;
            const maxRpmInput = document.getElementById('svarvning-max-rpm').value.trim();
            
            const material = svarvningData[materialKey] || { vcAuto: 250, kc: kcData.mjukt };
            const Vc = vcInput ? parseFloat(vcInput) : material.vcAuto;
            const kc = material.kc;

            const n_theoretic = (Vc * 1000) / (Math.PI * D);

            let n_final;
            if (maxRpmInput && parseFloat(maxRpmInput) > 0) {
                const N_Max = parseFloat(maxRpmInput);
                n_final = Math.min(n_theoretic, N_Max);
            } else {
                n_final = n_theoretic;
            }

            const Vf = n_final * f; // Matningshastighet (mm/min)
            
            // Avverkad volym Q (i cm¬≥/min)
            // Q = ap * f * Vc * 1000 (mm¬≥ / min)
            const Q_mm3 = ap * f * Vc * 1000; 
            const Q_cm3 = Q_mm3 / 1000; 

            // Effekt Pc (Pc = Q_mm3 * kc / (60 * 10^6))
            const Pc = (Q_mm3 * kc) / (60 * 1000 * 1000); 

            // Vridmoment M (M = Pc * 9550 / N)
            const M_Nm = (Pc * 9550) / n_final;

            document.getElementById('svarvning-vcAuto').textContent = material.vcAuto;
            document.getElementById('svarvning-kc').textContent = kc.toFixed(0) + ' N/mm¬≤';
            document.getElementById('svarvning-varvtal').textContent = Math.round(n_final);
            document.getElementById('svarvning-matning').textContent = Math.round(Vf);
            document.getElementById('svarvning-avverkad-volym').textContent = Q_cm3.toFixed(1) + ' cm¬≥/min';
            document.getElementById('svarvning-effekt').textContent = Pc.toFixed(2) + ' kW';
            document.getElementById('svarvning-vridmoment').textContent = M_Nm.toFixed(1) + ' Nm';
        }
        // SLUT NY FUNKTION F√ñR SVARVNING


        // --- NY FUNKTIONER F√ñR TIPS RUTAN ---
        function updateTipsBox(tabName) {
            const content = uniqueTips[tabName] || '<p>Inga specifika tips f√∂r denna bearbetningsmetod. Allm√§nna regler g√§ller (rigiditet, kylning, medfr√§sning).</p>';
            const tipsContentDiv = document.getElementById('tips-content-container');
            tipsContentDiv.innerHTML = content;
        }

        function toggleTipsBox() {
            const contentDiv = document.getElementById('tips-content-container');
            const toggleIcon = document.getElementById('tips-toggle-icon');
            
            const isExpanded = contentDiv.classList.toggle('expanded');
            toggleIcon.textContent = isExpanded ? '‚àí' : '+';
        }
        
        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`.tabs button[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            
            // Uppdatera tipsrutan
            updateTipsBox(tabName);

            // St√§ng tipsrutan om den √§r √∂ppen vid flikbyte (b√§ttre UX)
            const contentDiv = document.getElementById('tips-content-container');
            if (contentDiv.classList.contains('expanded')) {
                toggleTipsBox(); 
            }
            
            // Utf√∂r ber√§kning
            if (tabName === 'frasning') calculateFrasning();
            if (tabName === 'planfrasning') calculatePlanfrasning();
            if (tabName === 'gangfrasning') calculateGangfrasning();
            if (tabName === 'borrning') calculateBorrning();
            if (tabName === 'brotschning') calculateBrotschning();
            if (tabName === 'svarvning') calculateSvarvning(); // NY FLIK
        }
        // --- SLUT P√Ö NY FUNKTIONER F√ñR TIPS RUTAN ---


        // Event listeners
        ['frasning-material', 'frasning-diameter', 'frasning-vc', 'frasning-ap', 'frasning-ingrepp', 
         'frasning-tander', 'frasning-fz', 'frasning-max-rpm'].forEach(id => {
            document.getElementById(id).addEventListener('input', calculateFrasning);
        });
        document.getElementById('frasning-diameter').addEventListener('change', setFrasningFzByDiameter);
        
        // LISTENERS F√ñR PLANFR√ÑSNING
        ['planfrasning-material', 'planfrasning-diameter', 'planfrasning-vc', 'planfrasning-ap', 'planfrasning-ingrepp', 
         'planfrasning-tander', 'planfrasning-fz', 'planfrasning-max-rpm'].forEach(id => {
            document.getElementById(id).addEventListener('input', calculatePlanfrasning);
        });

        // LISTENERS F√ñR G√ÑNGFR√ÑSNING
        ['gangfrasning-material', 'gangfrasning-diameter', 'gangfrasning-vc', 'gangfrasning-ingrepp', 
         'gangfrasning-tander', 'gangfrasning-fz', 'gangfrasning-max-rpm'].forEach(id => {
            document.getElementById(id).addEventListener('input', calculateGangfrasning);
        });

        // LISTENERS F√ñR BORRNING 
        ['borrning-material', 'borrning-langd', 'borrning-diameter', 'borrning-vc', 'borrning-f', 'borrning-max-rpm'].forEach(id => {
            document.getElementById(id).addEventListener('input', calculateBorrning);
        });

        // LISTENERS F√ñR BROTSCHNING 
        ['brotschning-material', 'brotschning-diameter', 'brotschning-vc', 
         'brotschning-tander', 'brotschning-fz', 'brotschning-max-rpm'].forEach(id => {
            document.getElementById(id).addEventListener('input', calculateBrotschning);
        });

        // LISTENERS F√ñR SVARVNING (NY)
        ['svarvning-material', 'svarvning-diameter', 'svarvning-vc', 'svarvning-ap', 'svarvning-f', 'svarvning-max-rpm'].forEach(id => {
            document.getElementById(id).addEventListener('input', calculateSvarvning);
        });


        function resetAll() {
            // Fr√§sning
            document.getElementById('frasning-material').value = 'mjukt';
            document.getElementById('frasning-diameter').value = '12';
            document.getElementById('frasning-vc').value = '';
            document.getElementById('frasning-ap').value = '5'; // NY
            document.getElementById('frasning-ingrepp').value = '10';
            document.getElementById('frasning-tander').value = '4';
            document.getElementById('frasning-fz').value = '0.060';
            document.getElementById('frasning-max-rpm').value = '';
            
            // Planfr√§sning
            document.getElementById('planfrasning-material').value = 'mjukt';
            document.getElementById('planfrasning-diameter').value = '63';
            document.getElementById('planfrasning-vc').value = '';
            document.getElementById('planfrasning-ap').value = '1.5'; // NY
            document.getElementById('planfrasning-ingrepp').value = '80'; 
            document.getElementById('planfrasning-tander').value = '6'; 
            document.getElementById('planfrasning-fz').value = '0.18';
            document.getElementById('planfrasning-max-rpm').value = '';
            
            // G√§ngfr√§sning
            document.getElementById('gangfrasning-material').value = 'mjukt';
            document.getElementById('gangfrasning-diameter').value = '10';
            document.getElementById('gangfrasning-vc').value = '';
            document.getElementById('gangfrasning-ingrepp').value = '20';
            document.getElementById('gangfrasning-tander').value = '3';
            document.getElementById('gangfrasning-fz').value = '0.08';
            document.getElementById('gangfrasning-max-rpm').value = '';
            
            // Borrning
            document.getElementById('borrning-material').value = 'hart';
            document.getElementById('borrning-langd').value = '4-5';
            document.getElementById('borrning-diameter').value = '4.3';
            document.getElementById('borrning-vc').value = '';
            document.getElementById('borrning-f').value = ''; // NY
            document.getElementById('borrning-max-rpm').value = ''; 

            // Brotschning
            document.getElementById('brotschning-material').value = 'mjukt';
            document.getElementById('brotschning-diameter').value = '10';
            document.getElementById('brotschning-vc').value = '';
            document.getElementById('brotschning-tander').value = '6';
            document.getElementById('brotschning-fz').value = '';
            document.getElementById('brotschning-max-rpm').value = ''; 

            // Svarvning (NY)
            document.getElementById('svarvning-material').value = 'mjukt';
            document.getElementById('svarvning-diameter').value = '50';
            document.getElementById('svarvning-vc').value = '';
            document.getElementById('svarvning-ap').value = '2.0';
            document.getElementById('svarvning-f').value = '0.25';
            document.getElementById('svarvning-max-rpm').value = '';
            
            // Utf√∂r ber√§kningar och uppdateringar
            setFrasningFzByDiameter();
            calculatePlanfrasning();
            calculateGangfrasning();
            calculateBorrning();
            calculateBrotschning();
            calculateSvarvning(); // NY
            
            // St√§ng tipsrutan vid √•terst√§llning
            const contentDiv = document.getElementById('tips-content-container');
            if (contentDiv.classList.contains('expanded')) {
                toggleTipsBox(); 
            }
        }

        // Starta
        setFrasningFzByDiameter();
        calculatePlanfrasning();
        calculateGangfrasning();
        calculateBorrning();
        calculateBrotschning();
        calculateSvarvning(); // NY
        updateTipsBox('frasning'); // Ladda in initiala tips
    </script>
</body>
</html>
